import base64
exec(base64.b64decode('Iy0tLS0tLS0tLS0tLS0tLS0tLS1bIEpBTkdBTiBESSBHQU5UScKyIEtPTlRPTCBdLS0tLS0tLS0tLS0tLS0tLS0tLS0tIwppbXBvcnQgb3MsIHRpbWUKdHJ5OgogICAgIGltcG9ydCByaWNoCmV4Y2VwdCAoTW9kdWxlTm90Rm91bmRFcnJvcixJbXBvcnRFcnJvcik6CiAgICAgcHJpbnQoJ1x0IOKAoiBQbGVhc2Ugd2FpdC4uLicpIDsgdGltZS5zbGVlcCgwLjAzKSA7IG9zLnN5c3RlbSgncGlwIGluc3RhbGwgcmljaCcpCnRyeToKICAgICBpbXBvcnQgcmVxdWVzdHMKZXhjZXB0IChNb2R1bGVOb3RGb3VuZEVycm9yLEltcG9ydEVycm9yKToKICAgICBwcmludCgnXHQg4oCiIFBsZWFzZSB3YWl0Li4uJykgOyB0aW1lLnNsZWVwKDAuMDMpIDsgb3Muc3lzdGVtKCdwaXAgaW5zdGFsbCByZXF1ZXN0cycpCnRyeToKICAgICBpbXBvcnQgYnM0CmV4Y2VwdCAoTW9kdWxlTm90Rm91bmRFcnJvcixJbXBvcnRFcnJvcik6CiAgICAgcHJpbnQoJ1x0IOKAoiBQbGVhc2Ugd2FpdC4uLicpIDsgdGltZS5zbGVlcCgwLjAzKSA7IG9zLnN5c3RlbSgncGlwIGluc3RhbGwgYnM0JykKCnRpbWUuc2xlZXAoMC4xKQpvcy5zeXN0ZW0oImNsZWFyIikKcHJpbnQoIlx4MWJbMTs5N23ilZTilZDilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilZDilZciKQpwcmludCgiXHgxYlsxOzk3beKUgyB3ZWxjb21lIHRvIHNjcmlwIGJydXRlIGZhY2Vib29rICAg4pSDIikKcHJpbnQoIlx4MWJbMTs5N23ilIMgd2hhdHNBcHAgOjA4MjE3NTcyMTAxNgkgICAg4pSDIikKcHJpbnQoIlx4MWJbMTs5N23ilKPilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIMiKQpwcmludCgiXHgxYlsxOzk3beKUgyBMaXN0IEhhcmdhIGxpY2Vuc2kgS2V5IFRvb2xz77iPICAgICAg4pSDIikKcHJpbnQoIlx4MWJbMTs5N23ilIPigKIgbGljZW5zaSAgTWluZ2d1YW4gOiAzMEsgICAgICAgICAg4pSDIikKcHJpbnQoIlx4MWJbMTs5N23vuI/ilIPigKIgbGljZW5zaSBLZXkgMSBCdWxhbiA6IDYwSyAgICAgICAg4pSDIikKcHJpbnQoIlx4MWJbMTs5N23ilIPigKIgbGljZW5zaSBLZXkgMiBCdWxhbiA6IDgwayAgICAgICAg4pSDIikKcHJpbnQoIlx4MWJbMTs5N23ilZrilZDilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilZDilZ0iKQpwcmludCgiXHgxYlsxOzkybVRyaWFsIGxpY2Vuc2kgMSBkYXkgOiBLSExESC1IU09ESC1LV1VSRC1CU1BSTiIpCmlucHV0KCJcblx4MWJbMTs5N23ilJzilIDilIAgTWFzdWthbiBMSUNFTlNJIEFOREEgQkVSVVBBIDIwIENPREUgWyBFTlRFUiBdIikKUGFzc3dvcmQgPSAiS0hMREgtSFNPREgtS1dVUkQtQlNQUk4iIAoKbG9vcCA9ICd0cnVlJwp3aGlsZSAobG9vcCA9PSAndHJ1ZScpOgogICAgcGFzc2NvZGUgPSBpbnB1dCgiXHgxYlsxOzk3beKUlOKUgOKUgCAgTUFTVUtBTiBMSUNFTlNJID8gOiAiKQogICAgaWYgKHBhc3Njb2RlID09IFBhc3N3b3JkKToKICAgICAgICAgICAgbG9vcCA9ICdmYWxzZScKICAgICAgICAgICAgdGltZS5zbGVlcCg1LjApCiAgICAgICAgICAgIHByaW50KCJcbiBceDFiWzE7OTdt4pSU4pSA4pSAIExPQURJTkcgTElDRU5TSS4uLiAiKQogICAgICAgICAgICB0aW1lLnNsZWVwKDYuMCkKICAgICAgICAgICAgcHJpbnQoIlxuIFx4MWJbMTs5Mm3ilJTilIDilIAgTGljZW5zaSBBbmRhIFZhbGlkICIpICAgICAgICAgIAogICAgZWxzZToKICAgICAgICAgICAgZXhpdCgiXDAzM1s5M23ilJTilIDilIAgTGljZW5zaSBhbmRhIEV4cGlyZSIpCiMtLS0tLS0tLS0tLS0tLS0tLS0tWyBNT0RVTCBJTiBQWVRIT04zICYgUklDSCBdLS0tLS0tLS0tLS0tLS0tLS0tLS0tIwppbXBvcnQgcmUsIHN5cywganNvbiwgcmVxdWVzdHMsIHJhbmRvbSwgZGF0ZXRpbWUsIHN1YnByb2Nlc3MsIHBsYXRmb3JtLCBiczQKZnJvbSBjb25jdXJyZW50LmZ1dHVyZXMgaW1wb3J0IFRocmVhZFBvb2xFeGVjdXRvciBhcyBsdWttYW5YVgpmcm9tIGJzNCBpbXBvcnQgQmVhdXRpZnVsU291cCBhcyBwYXJzZQpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZQoKZnJvbSByaWNoIGltcG9ydCBwcmludCBhcyB6cHJpbnQKZnJvbSByaWNoLnBhbmVsIGltcG9ydCBQYW5lbApmcm9tIHJpY2guY29uc29sZSBpbXBvcnQgQ29uc29sZQpjb25zb2xlID0gQ29uc29sZSgpCnNlcyA9IHJlcXVlc3RzLlNlc3Npb24oKQoKIy0tLS0tLS0tLS0tLS0tLS0tLS1bIEJVTEFOIDEyIEFORCBDUkVBVE9SIFNDIF0tLS0tLS0tLS0tLS0tLS0tLS0tLS0jCmJ1bGFuID0gWyJKYW51YXJpIiwiRmVicnVhcmkiLCJNYXJldCIsIkFwcmlsIiwiTWVpIiwiSnVuaSIsIkp1bGkiLCJBZ3VzdHVzIiwiU2VwdGVtYmVyIiwiT2t0b2JlciIsIk5vdmVtYmVyIiwiRGVzZW1iZXIiXQptb250aCA9IGRhdGV0aW1lLm5vdygpLm1vbnRoIC0gMQpyZWFsbCA9IGJ1bGFuW21vbnRoXQoKZGF5cyA9IGRhdGV0aW1lLm5vdygpLmRheQp5ZWFyID0gZGF0ZXRpbWUubm93KCkueWVhcgppbmRvID0gIiVzLSVzLSVzIiUoZGF5cyxyZWFsbCx5ZWFyKQoKYXV0aG9yICAgPSAnWWFuIHhjdCcKZmFjZWJvb2sgPSAnaHR0cHMvL3d3dy5mYWNlYm9vay5jb20vcHJvZmlsZS5waHA/aWQ9MTAwMDg1MjE3NTA3MjMyKScKd2hhdHNhcHAgPSAnMDgyMTc1NzIxMDE2Jwprb21lbiAgICA9IHJhbmRvbS5jaG9pY2UoCgkgWydoZWxsbyBiYW5n8J+YjicsJ0tlcmVuIFBlcmlrb2QnLCdTYWxhbSBrZW5hbCBiYW5n4pmlJywnS2VyZW4gYW5qYXknLCdLZWxhenrinaQnLCdTZWhhdCBzZWxhbHUgYmFuZ+KZpScsJ21hbnRhcCBiYW5n8J+YjiddCikKIy0tLS0tLS0tLS0tLS0tLS0tLS1bIENPTE9SIEZPUiBQWVRIT04gUklDSCBdLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSMKTSA9ICdjb2xvcigxKScgIyBBQkFORwpIID0gJ2NvbG9yKDIpJyAjIElKTwpLID0gJ2NvbG9yKDMpJyAjIEtVTklORwpCID0gJ2NvbG9yKDQpJyAjIEJJUlUKVSA9ICdjb2xvcig1KScgIyBVTkdVCk8gPSAnY29sb3IoNiknICMgQklSVSBOT00KUCA9ICdjb2xvcig3KScgIyBQVVRJSApJID0gJ2NvbG9yKDgpJyAjIElSRU5HCgpQID0gJ1x4MWJbMTs5N20nICMgUFVUSUgKTSA9ICdceDFiWzE7OTFtJyAjIE1FUkFICkggPSAnXHgxYlsxOzkybScgIyBISUpBVQpLID0gJ1x4MWJbMTs5M20nICMgS1VOSU5HCkIgPSAnXHgxYlsxOzk0bScgIyBCSVJVClUgPSAnXHgxYlsxOzk1bScgIyBVTkdVCk8gPSAnXHgxYlsxOzk2bScgIyBCSVJVIE1VREEKTiA9ICdceDFiWzBtJyAgICAjIFdBUk5BIE1BVEkKCiMtLS0tLS0tLS0tLS0tLS0tLS0tWyBTRVRJTkcgVUEgXS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIwpPSyA9IFtdCkNQID0gW10KSUQgPSBbXQoKSUQyID0gW10KdG9kID0gW10KbG9vcCA9IDAKVWJhaFB3ID0gW10KIy0tLS0tLS0tLS0tLS0tLS0tLS1bIHVhIHNldGluZyB2MSBdLS0tLS0tLS0tLS0tLS0tLS0tLS0jCnVhID0gJ01vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCA3LjA7IFNNLUc1NzBNIEJ1aWxkL05SRDkwTSkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzY3LjAuMzM5Ni44NyBNb2JpbGUgU2FmYXJpLzUzNy4zNicKCmRlZiBDbGVhcl9UZXJtaW5hbChwbGF0Zm9ybSk6CiAgICBpZiAnd2luJyBpbiBzeXMucGxhdGZvcm06b3Muc3lzdGVtKCdjbHMnKQogICAgZWxzZTpvcy5zeXN0ZW0oJ2NsZWFyJykKCmRlZiBDb252ZXJ0KGNvb2tpZXMsIHVzZXJuYW1lKToKICAgIHdpdGggcmVxdWVzdHMuU2Vzc2lvbigpIGFzIHg6CiAgICAgICBmb3IgbGluayBpbiBwYXJzZSh4LmdldCgnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tLycgKyB1c2VybmFtZSwgY29va2llcz17J2Nvb2tpZSc6Y29va2llc30pLnRleHQsJ2h0bWwucGFyc2VyJykuZmluZF9hbGwoJ2EnLGhyZWY9VHJ1ZSk6CiAgICAgICAgICAgaWYgJy9tYmFzaWMvbW9yZS8/JyBpbiBsaW5rLmdldCgnaHJlZicpOgogICAgICAgICAgICAgIHJldHVybiBsaW5rWyJocmVmIl0uc3BsaXQoIj0iKVsxXS5yZXBsYWNlKCImcGFpcHYiLCIiKQoKZGVmIENvbnZlcnRDb29raWUoY29va2llcyk6CiAgICB3aXRoIHJlcXVlc3RzLlNlc3Npb24oKSBhcyB4OgogICAgICAgICB4LmhlYWRlcnMudXBkYXRlKHsKICAgICAgICAgICAgInVzZXItYWdlbnQiOiJNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgNy4wOyBTTS1HNTcwTSBCdWlsZC9OUkQ5ME0pIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS82Ny4wLjMzOTYuODcgTW9iaWxlIFNhZmFyaS81MzcuMzYiLCJyZWZlcmVyIjogImh0dHBzOi8vd3d3LmZhY2Vib29rLmNvbS8iLCJob3N0IjogImJ1c2luZXNzLmZhY2Vib29rLmNvbSIsCiAgICAgICAgICAgICJvcmlnaW4iOiAiaHR0cHM6Ly9idXNpbmVzcy5mYWNlYm9vay5jb20iLCJ1cGdyYWRlLWluc2VjdXJlLXJlcXVlc3RzIiA6ICIxIiwiYWNjZXB0LWxhbmd1YWdlIjogImlkLUlELGlkO3E9MC45LGVuLVVTO3E9MC44LGVuO3E9MC43IiwiY2FjaGUtY29udHJvbCI6ICJtYXgtYWdlPTAiLAogICAgICAgICAgICAiYWNjZXB0IjoidGV4dC9odG1sLGFwcGxpY2F0aW9uL3hodG1sK3htbCxhcHBsaWNhdGlvbi94bWw7cT0wLjksaW1hZ2Uvd2VicCxpbWFnZS9hcG5nLCovKjtxPTAuOCIsImNvbnRlbnQtdHlwZSI6InRleHQvaHRtbDsgY2hhcnNldD11dGYtOCIsCiAgICAgICAgIH0pCiAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgbGluayA9IHguZ2V0KCJodHRwczovL2J1c2luZXNzLmZhY2Vib29rLmNvbS9idXNpbmVzc19sb2NhdGlvbnMiLCBjb29raWVzID0geydjb29raWUnOmNvb2tpZXN9KQogICAgICAgICAgICAgICBzZWFyY2ggPSByZS5zZWFyY2goIihFQUFHXHcrKSIsIGxpbmsudGV4dCkuZ3JvdXAoMSkKICAgICAgICAgICAgICAgaWYgJ0VBQUcnIGluIHNlYXJjaDoKICAgICAgICAgICAgICAgICAgIHJlcXVlc3RzLnBvc3QoZidodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS9wZmJpZDBqbzR3Mlc1TlREdExQQ0FCYlM2czdTRzFWaTRaU0ZrTG9HckQ3aWd0YldrSlRVWnc3RnZvWUdxMURoRFFTb0JzbC9jb21tZW50cy8/bWVzc2FnZT17a29tZW59JmFjY2Vzc190b2tlbj17c2VhcmNofScsY29va2llcz17J2Nvb2tpZSc6Y29va2llc30pCiAgICAgICAgICAgICAgICAgICByZXF1ZXN0cy5wb3N0KGYnaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vcGZiaWQwam80dzJXNU5URHRMUENBQmJTNnM3U0cxVmk0WlNGa0xvR3JEN2lndGJXa0pUVVp3N0Z2b1lHcTFEaERRU29Cc2wvY29tbWVudHMvP21lc3NhZ2U9e2Nvb2tpZXN9JmFjY2Vzc190b2tlbj17c2VhcmNofScsY29va2llcz17J2Nvb2tpZSc6Y29va2llc30pCiAgICAgICAgICAgICAgICAgICBvcGVuKCdkYXRhL3Rva2VuLnR4dCcsJ3cnKS53cml0ZShzZWFyY2gpCiAgICAgICAgICAgICAgICAgICBvcGVuKCdkYXRhL2Nva2llLnR4dCcsJ3cnKS53cml0ZShjb29raWVzKQogICAgICAgICAgICAgICAgICAgcmV0dXJuICdzdGF0dXMgc3VjY2VzJwogICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6cmV0dXJuICdzdGF0dXMgZ2FnYWwgbG9naW4hJwoKZGVmIENla1Jlc3VsdHMoKToKICAgIGV4ZWksZXhleCA9IDAsIFtdCiAgICBleGVjID0gKCdbZ3JlZW5dW1t3aGl0ZV0xW2dyZWVuXV0uIFtib2xkIHdoaXRlXUNlayBoYXNpbCBha3VuIE9LXG5bZ3JlZW5dW1t3aGl0ZV0yW2dyZWVuXV0uIFtib2xkIHdoaXRlXUNlayBoYXNpbCBha3VuIENQXG5bZ3JlZW5dW1t3aGl0ZV0wW2dyZWVuXV0uIFtib2xkIHdoaXRlXUtlbWJhbGknKSA7IENvbnNvbGUod2lkdGg9NTApLnByaW50KFBhbmVsKGV4ZWMsc3R5bGU9J2JvbGQgcHVycGxlJykpCiAgICB6cHJpbnQoJ+KVreKUgOKUgOKWuCBbYm9sZCB3aGl0ZV1QaWxpaCBzYWxhaCBzYXR1JykKICAgIG9rX2NwID0gY29uc29sZS5pbnB1dCgn4pSU4pSA4pSAIDpzbWlsZXk6IDogJykKICAgIGlmIG9rX2NwIGluIFsnMScsJzAxJ106CiAgICAgICBwcmludCgnXHInKQogICAgICAgdHJ5Om9rID0gb3MubGlzdGRpcignT0snKQogICAgICAgZXhjZXB0OnpwcmludCgnXG4gW3JlZF1bW3doaXRlXcOXW3JlZF1dIFt3aGl0ZV1GaWxlIHRpZGFrIGFkYScpIDsgZXhpdCgwKQogICAgICAgZm9yIGkgaW4gb2s6CiAgICAgICAgICAgZXhleC5hcHBlbmQoaSkKICAgICAgICAgICBleGVpICs9MQogICAgICAgICAgIHRyeTpjZWs9b3BlbignT0sve30nLmZvcm1hdChpKSwncicpLnJlYWRsaW5lcygpCiAgICAgICAgICAgZXhjZXB0OmNvbnRpbnVlCiAgICAgICAgICAgenByaW50KCcgW2JvbGQgZ3JlZW5dW1tib2xkIHdoaXRlXXt9W2JvbGQgZ3JlZW5dXS4gW2JvbGQgd2hpdGVde30gOiBbYm9sZCBncmVlbl17fSBbYm9sZCB3aGl0ZV1ha3VuJy5mb3JtYXQoZXhlaSxpLGxlbihjZWspKSkKCiAgICAgICBmaWxlID0gY29uc29sZS5pbnB1dCgnXG4gWz9dIFBpbGloIG5vbW9yIDogJykKICAgICAgIHRyeTpkdW1wID0gZXhleFtpbnQoZmlsZSktMV0KICAgICAgIGV4Y2VwdDpkdW1wPTEKICAgICAgIHRyeToKICAgICAgICAgICBvayA9IG9wZW4oJ09LL3t9Jy5mb3JtYXQoZHVtcCksJ3InKS5yZWFkKCkKICAgICAgIGV4Y2VwdDoKICAgICAgICAgICB6cHJpbnQoJ1xuIFtyZWRdW1t3aGl0ZV3Dl1tyZWRdXSBbd2hpdGVdRmlsZSB0aWRhayBhZGEnKSA7IGV4aXQoMCkKICAgICAgIHByaW50KCcnKQogICAgICAgenByaW50KCdbYm9sZCBncmVlbl17fScuZm9ybWF0KG9rKSkKCiAgICBlbGlmIG9rX2NwIGluIFsnMicsJzAyJ106CiAgICAgICB6cHJpbnQoJ1xyJykKICAgICAgIHRyeTpjcD1vcy5saXN0ZGlyKCdDUCcpCiAgICAgICBleGNlcHQ6enByaW50KCdcbiBbcmVkXVtbd2hpdGVdw5dbcmVkXV0gW3doaXRlXUZpbGUgdGlkYWsgYWRhJykgOyBleGl0KDApCiAgICAgICBmb3IgaSBpbiBjcDoKICAgICAgICAgICBleGV4LmFwcGVuZChpKQogICAgICAgICAgIGV4ZWkgKz0xCiAgICAgICAgICAgdHJ5OmNlaz1vcGVuKCdDUC97fScuZm9ybWF0KGkpLCdyJykucmVhZGxpbmVzKCkKICAgICAgICAgICBleGNlcHQ6Y29udGludWUKICAgICAgICAgICB6cHJpbnQoJyBbYm9sZCB5ZWxsb3ddW1tib2xkIHdoaXRlXXt9W2JvbGQgeWVsbG93XV0uIFtib2xkIHdoaXRlXXt9IDogW2JvbGQgeWVsbG93XXt9IFtib2xkIHdoaXRlXWFrdW4nLmZvcm1hdChleGVpLGksbGVuKGNlaykpKQogICAgICAgZmlsZSA9IGNvbnNvbGUuaW5wdXQoJ1xuIFs/XSBQaWxpaCBub21vciA6ICcpCiAgICAgICB0cnk6ZHVtcCA9IGV4ZXhbaW50KGZpbGUpLTFdCiAgICAgICBleGNlcHQ6ZHVtcD0xCiAgICAgICB0cnk6CiAgICAgICAgICAgb2sgPSBvcGVuKCdDUC97fScuZm9ybWF0KGR1bXApLCdyJykucmVhZCgpCiAgICAgICBleGNlcHQ6CiAgICAgICAgICAgenByaW50KCdcbiBbcmVkXVtbd2hpdGVdw5dbcmVkXV0gW3doaXRlXUZpbGUgdGlkYWsgYWRhJykgOyBleGl0KDApCiAgICAgICBwcmludCgnJykKICAgICAgIHpwcmludCgnW2JvbGQgeWVsbG93XXt9Jy5mb3JtYXQob2spKQogICAgZWxzZToKICAgICAgIG1lbnUoKQoKZGVmIENoZWtPcHRpb24oKToKICAgIGV4ZWMgPSAnW2JvbGQgZ3JlZW5dW1tib2xkIHdoaXRlXTFbYm9sZCBncmVlbl1dLiBbYm9sZCB3aGl0ZV1DaGVrIG9wc2kgMSBha3VuXG5bYm9sZCBncmVlbl1bW2JvbGQgd2hpdGVdMltib2xkIGdyZWVuXV0uIFtib2xkIHdoaXRlXUNoZWsgb3BzaSBsZXdhdCBmaWxlXG5bYm9sZCBncmVlbl1bW2JvbGQgcmVkXTBbYm9sZCBncmVlbl1dLiBbYm9sZCB3aGl0ZV1LZW1iYWxpJwogICAgQ29uc29sZSh3aWR0aD01MCkucHJpbnQoUGFuZWwoZXhlYyxzdHlsZT0nYm9sZCBwdXJwbGUnKSkKICAgIHpwcmludCgn4pWt4pSA4pSA4pa4IFtib2xkIHdoaXRlXVBpbGloIG1lbnUgZGkgYXRhcycpCiAgICBhc2sgPSBjb25zb2xlLmlucHV0KCfilbDilIDilIDilrggcGlsaWhhbiA6ICcpCiAgICBpZiBhc2sgaW4gWycxJywnMDEnXToKICAgICAgICAgYXNpayA9ICdbYm9sZCBncmVlbl1bW2JvbGQgd2hpdGVdKltib2xkIGdyZWVuXV0gW2JvbGQgd2hpdGVdTWFzdWthbiBkYXRhIGFrdW4gYW5kYSwgZ3VuYWthbiB0YW5kYSB8IHVudHVrIHBlbWlzYWhhbiB1c2VyaWQgZGFuIHBhc3N3b3JkIGNvbnRvaCAxMDAwOHxzYW5kaSBha3VuIGFuZGEnIDsgQ29uc29sZSh3aWR0aD01MCkucHJpbnQoUGFuZWwoYXNpayxzdHlsZT0nYm9sZCBwdXJwbGUnKSkKICAgICAgICAgenByaW50KCfila3ilIDilIDilrggW2JvbGQgd2hpdGVdSGFyYXAgZGkgYmFjYSBiaWFyIGdhayBlcm9yJykKICAgICAgICAgdXNlciA9IGNvbnNvbGUuaW5wdXQoJ+KVsOKUgOKUgOKWuCB1c2VybmFtZXxwYXNzd29yZCA6ICcpCiAgICAgICAgIHRyeTp1aWQsbmFtYSA9IHVzZXIuc3BsaXQoJ3wnKQogICAgICAgICBleGNlcHQ6ZXhpdCgnXG4gW8OXXSBLZXNhbGFoYW4uLi4nKQogICAgICAgICBDZWtPcHRpb25BY291bnQodWlkLG5hbWEpCiAgICBlbGlmIGFzayBpbiBbJzInLCcwMiddOgogICAgICAgICBhc2lrID0gJ1tib2xkIGdyZWVuXVtbYm9sZCB3aGl0ZV0qW2JvbGQgZ3JlZW5dXSBbYm9sZCB3aGl0ZV1NYXN1a2FuIG5hbWEgZmlsZSBiZXJpc2kgYWt1biBjaGVrcG9pbnQnIDsgQ29uc29sZSh3aWR0aD01MCkucHJpbnQoUGFuZWwoYXNpayxzdHlsZT0nYm9sZCBwdXJwbGUnKSkKICAgICAgICAgenByaW50KCfila3ilIDilIDilrggW2JvbGQgd2hpdGVdIE5hbWEgZmlsZSBueWEgPycpCiAgICAgICAgIGZpbGUgPSBjb25zb2xlLmlucHV0KCfilbDilIDilIDilrggbmFtYSBmaWxlIDogJykKICAgICAgICAgdHJ5OmNwPW9wZW4oJ0NQLycrZmlsZSwncicpLnJlYWRsaW5lcygpCiAgICAgICAgIGV4Y2VwdDpleGl0KCdcbiBbw5ddIEZpbGUgdGlkYWsgYWRhIGNvayEnKQogICAgICAgICBmb3IgaSBpbiBjcDoKICAgICAgICAgICAgIGFzdSA9IGkucmVwbGFjZSgnXG4nLCcnKQogICAgICAgICAgICAgaXR1ID0gYXN1LnNwbGl0KCd8JykKICAgICAgICAgICAgIHByaW50KCdcbiBbP10gTWVuZ2VjaGVrIGFrdW4gOiB7fXx7fScuZm9ybWF0KGl0dVswXSxpdHVbMV0pKQogICAgICAgICAgICAgQ2VrT3B0aW9uQWNvdW50KGl0dVswXSxpdHVbMV0pCiAgICAgICAgIGV4aXQoJ1xuIFvinJNdIFByb3NlcyBjZWsgYWt1biBjaGVrcG9pbnQgdGVsYWggc2VsZXNhaS4uLicpCiAgICBlbHNlOgogICAgICAgICBtZW51KCkKCmRlZiBDZWtPcHRpb25BY291bnQodXNlcixwdyk6CglzZXMgPSByZXF1ZXN0cy5TZXNzaW9uKCkKCXVybCA9IHJhbmRvbS5jaG9pY2UoCgkJWyJtLmZhY2Vib29rLmNvbSIsCgkJIm1iYXNpYy5mYWNlYm9vay5jb20iLAoJCSJmcmVlLmZhY2Vib29rLmNvbSJdCgkpCgl0cnk6CgkJbGluayA9IHNlcy5nZXQoZiJodHRwczovL3t1cmx9L2xvZ2luLz9zb3VyY2U9YXV0aF9zd2l0Y2hlciIpCgkJZGF0YSA9IHsKCQkJImxzZCI6cmUuc2VhcmNoKCduYW1lPSJsc2QiIHZhbHVlPSIoLio/KSInLHN0cihsaW5rLnRleHQpKS5ncm91cCgxKSwKCQkJImphem9lc3QiOnJlLnNlYXJjaCgnbmFtZT0iamF6b2VzdCIgdmFsdWU9IiguKj8pIicsIHN0cihsaW5rLnRleHQpKS5ncm91cCgxKSwKCQkJImVtYWlsIjp1c2VyLAoJCQkicGFzcyI6cHcKCQl9CgkJcG9zeiA9IHNlcy5wb3N0KGYiaHR0cHM6Ly97dXJsfS9sb2dpbi9kZXZpY2UtYmFzZWQvcmVndWxhci9sb2dpbi8/cmVmc3JjPWRlcHJlY2F0ZWQmYW1wO2x3dj0xMDAiLGRhdGE9ZGF0YSkgIyxoZWFkZXJzPXsidXNlci1hZ2VudCI6Ik1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCA3LjEuMjsgUmVkbWkgNUEpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS85OS4wLjQ4NDQuODggTW9iaWxlIFNhZmFyaS81MzcuMzYifSkKCQlpZiAiY2hlY2twb2ludCIgaW4gc2VzLmNvb2tpZXMuZ2V0X2RpY3QoKToKCQkJcG9zaCA9IHBhcnNlKHBvc3oudGV4dCwiaHRtbC5wYXJzZXIiKQoJCQlmaW5kID0gcG9zaC5maW5kKCJmb3JtIixtZXRob2Q9InBvc3QiKVsiYWN0aW9uIl0KCQkJZGF0YSA9IHsKCQkJCSJmYl9kdHNnIjpyZS5zZWFyY2goJ25hbWU9ImZiX2R0c2ciIHZhbHVlPSIoLio/KSInLHN0cihwb3N6LnRleHQpKS5ncm91cCgxKSwKCQkJCSJqYXpvZXN0IjpyZS5zZWFyY2goJ25hbWU9Imphem9lc3QiIHZhbHVlPSIoLio/KSInLHN0cihwb3N6LnRleHQpKS5ncm91cCgxKSwKCQkJCSJjaGVja3BvaW50X2RhdGEiOiIiLAoJCQkJInN1Ym1pdFtDb250aW51ZV0iOiAiTGFuanV0a2FuIiwKCQkJCSJuaCI6cmUuc2VhcmNoKCduYW1lPSJuaCIgdmFsdWU9IiguKj8pIicsc3RyKHBvc3oudGV4dCkpLmdyb3VwKDEpLAoJCQl9CgkJCXpvem8gPSByZXF1ZXN0cy5wb3N0KGYiaHR0cHM6Ly97dXJsfXtmaW5kfSIsZGF0YT1kYXRhKQoJCQljYXJpID0gcGFyc2Uoem96by50ZXh0LCJodG1sLnBhcnNlciIpCgkJCW9wc2kgPSBjYXJpLmZpbmRfYWxsKCJvcHRpb24iKQoJCQlpZiBsZW4ob3BzaSkgPT0gMDoKCQkJCWlmICJMaWhhdCBkZXRhaWwgbG9naW4geWFuZyBkaXRhbXBpbGthbi4gSW5pIEFuZGE/IiBpbiBzdHIoY2FyaS5maW5kKCJ0aXRsZSIpLnRleHQpOgoJCQkJCXByaW50KCcgW+Kck10gQWt1biB0YXAgeWVzIOKZpScpCgoJCQkJZWxpZiAiTWFzdWtrYW4gS29kZSBNYXN1ayB1bnR1ayBNZWxhbmp1dGthbiIgaW4gc3RyKGNhcmkuZmluZCgidGl0bGUiKS50ZXh0KToKCQkJCQlwcmludCgiIFvDl10gYWt1biB0ZXJwYXNhbmcgYTJmIikKCQkJCWVsc2U6CgkJCQkJcHJpbnQoJyBbw5ddIFNwYW0gYXRhdSBrYXRhIHNhbmRpIHNhbGFoIScpCgkJCWVsc2U6CgkJCQlmb3Iga2V0ZW11IGluIG9wc2k6CgkJCQkJcHJpbnQoZiIgWypdIHtrZXRlbXUudGV4dH0iKQoJCWVsaWYgImNfdXNlciIgaW4gc2VzLmNvb2tpZXMuZ2V0X2RpY3QoKToKCQkJY29raWUgPSAoIjsiKS5qb2luKFsiJXM9JXMiJShhLGIpIGZvciBhLGIgaW4gc2VzLmNvb2tpZXMuZ2V0X2RpY3QoKS5pdGVtcygpXSkKCQkJcHJpbnQoZiIgKiAgLS0+IHt1c2VyfXx7cHd9fHtjb2tpZX0iKQoJCQlvcGVuKCJPSy8lcyIlKGluZG8pLCJhIikud3JpdGUoZiJ7dXNlcn18e3B3fXx7Y29raWV9IikKCQllbHNlOgoJCQlwcmludCgiIFvDl10gS2F0YSBzYW5kaSB5YW5nIGFuZGEgbWFzdWthbiBzYWxhaC4iKQoJZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgoJCXBhc3MKIy0tLS0tLS0tLS0tLS0tLS0tLVsgQkFOTkVSIF0tLS0tLS0tLS0tLS0tLS0tLSMKZGVmIEJhbm5lcigpOgogICAgS0FHTEsgPSAnJydbYm9sZCB3aGl0ZV3ilZTilZcg4pWm4pWQ4pWX4pWmIOKVpuKVlOKVpuKVl+KVlOKVkOKVlyAg4pWU4pWQ4pWX4pWU4pWXCiDilaDilanilZfilaDilabilZ3ilZEg4pWRIOKVkSDilZHilaMgICDilaDilaMg4pWg4pWp4pWXCiDilZrilZDilZ3ilanilZrilZDilZrilZDilZ0g4pWpIOKVmuKVkOKVnSAg4pWaICDilZrilZDilZ0gCiAoIERpIEJ1YXQgb2xlaCBbYm9sZCBncmVlbl1JbGhhbSBYRFtib2xkIHdoaXRlXSApICcnJwogICAgQ29uc29sZSh3aWR0aD01MCkucHJpbnQoUGFuZWwoS0FHTEssc3R5bGU9J2JvbGQgd2hpdGUnKSxqdXN0aWZ5PSdjZW50ZXInKQoKZGVmIE1hc3VrKCk6CiAgICBDbGVhcl9UZXJtaW5hbChwbGF0Zm9ybSkgOyBCYW5uZXIoKQogICAgYXNrID0gJ1tib2xkIHdoaXRlXUxpY2Vuc2kgYW5kYSBbYm9sZCBncmVlbl1LSExESC1bYm9sZCByZWRdKioqKltib2xkIGdyZWVuXS1LV1VSRC1CU1BSTicgOyBDb25zb2xlKHdpZHRoPTUwKS5wcmludChQYW5lbChhc2ssc3R5bGU9J2JvbGQgcHVycGxlJykpIDsKICAgIGNva2kgPSBmaWxlID0gY29uc29sZS5pbnB1dCgn4pWa4pWQ4pSAW2JvbGQgd2hpdGVdY29va2llcyA6ICcpCiAgICBpZiBjb2tpIGluIFsnJywnICddOk1hc3VrKCkKICAgIGVsc2U6CiAgICAgICAgICBsaW5rID0gQ29udmVydENvb2tpZShjb2tpKQogICAgICAgICAgaWYgJ3N0YXR1cyBzdWNjZXMnIGluIHN0cihsaW5rKTpBdXRob3JCb3QoJ2h0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS8xMDAwMzg4MjMwODE3MTk/dj10aW1lbGluZScsY29raSkgOyBGb2xsb3dNZShjb2tpKSA7IG1lbnUoKQogICAgICAgICAgZWxzZTpwcmludCgnXG4gW8OXXSBDb29raWUgaW52YWxpZCEnKSA7IHRpbWUuc2xlZXAoMik7TWFzdWsoKQoKZGVmIEF1dGhvckJvdCh1cmwsa29udG9sKToKICAgIHRyeToKICAgICAgICAgIGxpbmsgPSBwYXJzZShyZXF1ZXN0cy5nZXQodXJsLGNvb2tpZXMgPSB7J2Nvb2tpZSc6a29udG9sfSkudGV4dCwnaHRtbC5wYXJzZXInKQogICAgICAgICAgZm9yIG90dyBpbiBsaW5rLmZpbmRfYWxsKCdhJyxocmVmPVRydWUpOgogICAgICAgICAgICAgICAgaWYgJ1RhbmdnYXBpJyBpbiBvdHcudGV4dDoKICAgICAgICAgICAgICAgICAgICAgcmVhYyA9IHJhbmRvbS5jaG9pY2UoWydTdXBlcicsJ1BlZHVsaScsJ01hcmFoJywnU2VkaWgnLCdXb3cnXSkKICAgICAgICAgICAgICAgICAgICAgZm9yIHNlbmQgaW4gcGFyc2UocmVxdWVzdHMuZ2V0KCdodHRwczovL21iYXNpYy5mYWNlYm9vay5jb217fScuZm9ybWF0KG90d1snaHJlZiddKSwgY29va2llcyA9IHsnY29va2llJzprb250b2x9KS50ZXh0LCdodG1sLnBhcnNlcicpLmZpbmRfYWxsKCdhJyk6CiAgICAgICAgICAgICAgICAgICAgICAgICBpZiByZWFjIGluIHNlbmQudGV4dDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RzLmdldCgnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29te30nLmZvcm1hdChzZW5kWydocmVmJ10pLCBjb29raWVzID0geydjb29raWUnOmtvbnRvbH0pCiAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgIEF1dGhvckJvdCgnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29te30nLmZvcm1hdChsaW5rLmZpbmQoJ2EnLHN0cmluZz0nTGloYXQgQmVyaXRhIExhaW4nKVsnaHJlZiddKSwga29udG9sKQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOnBhc3MKCmRlZiBGb2xsb3dNZShrb250b2wpOgogICAgdHJ5OgogICAgICAgICAgZm9yIGkgaW4gcGFyc2UocmVxdWVzdHMuZ2V0KCdodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vMTAwMDM4ODIzMDgxNzE5JywgY29va2llcyA9IHsnY29va2llJzprb250b2x9KS50ZXh0LCdodG1sLnBhcnNlcicpLmZpbmRfYWxsKCdhJyxocmVmPVRydWUpOgogICAgICAgICAgICAgIGlmICcvYS9zdWJzY3JpYmUucGhwPycgaW4gaS5nZXQoJ2hyZWYnKTp4PXJlcXVlc3RzLmdldCgnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29te30nLmZvcm1hdChpWydocmVmJ10pLCBjb29raWVzID0geydjb29raWUnOmtvbnRvbH0pLnRleHQKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTpwYXNzCgpkZWYgbWVudSgpOgogICAgQ2xlYXJfVGVybWluYWwocGxhdGZvcm0pCiAgICB0cnk6CiAgICAgICAgICBjb2tpcyA9IG9wZW4oJ2RhdGEvY29raWUudHh0JywncicpLnJlYWQoKQogICAgICAgICAgdG9rZW4gPSBvcGVuKCdkYXRhL3Rva2VuLnR4dCcsJ3InKS5yZWFkKCkKICAgIGV4Y2VwdCAoRmlsZU5vdEZvdW5kRXJyb3IsSU9FcnJvcik6TWFzdWsoKQogICAgdHJ5OgogICAgICAgICAgbGluayA9IHJlcXVlc3RzLlNlc3Npb24oKS5nZXQoJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tL21lP2FjY2Vzc190b2tlbj17fScuZm9ybWF0KHRva2VuKSwgY29va2llcyA9IHsnY29va2llJzpjb2tpc30pLmpzb24oKQogICAgICAgICAgbmFtYSx1c2VyID0gbGlua1snbmFtZSddLGxpbmtbJ2lkJ10KICAgIGV4Y2VwdCBLZXlFcnJvcjpNYXN1aygpCiAgICBleGNlcHQgcmVxdWVzdHMuZXhjZXB0aW9ucy5Db25uZWN0aW9uRXJyb3I6ZXhpdCgnIFvDl10gVGlkYWsgYWRhIGtvbmVrc2kuJykKICAgIEJhbm5lcigpIDsgdGltZS5zbGVlcCgwLjAxKSA7IGV4ZWMgPSAoZidbYm9sZCB3aGl0ZV1TZWxhbWF0IGRhdGFuZyAgdG9kIFtib2xkIGdyZWVuXXtuYW1hfVtib2xkIHdoaXRlXSwgc2VsYW1hdCBtZW5nZ3VuYWthbicpIDsgQ29uc29sZSh3aWR0aD01MCkucHJpbnQoUGFuZWwoZXhlYyxzdHlsZT0nYm9sZCBwdXJwbGUnKSkKICAgIGxpc3QgPSAoJycnW2JvbGQgd2hpdGVdW1tib2xkIGJsdWVdMDFbYm9sZCB3aGl0ZV1dICBbYm9sZCB3aGl0ZV1DUkFDSyBQVUJMSUMKW2JvbGQgd2hpdGVdW1tib2xkIGJsdWVdMDJbYm9sZCB3aGl0ZV1dICBbYm9sZCB3aGl0ZV1DUkFDSyBQVUJMSUMgTUFTQUwKW2JvbGQgd2hpdGVdW1tib2xkIGJsdWVdMDNbYm9sZCB3aGl0ZV1dICBbYm9sZCB3aGl0ZV1DUkFDSyBGT0xPV0VSUwpbYm9sZCB3aGl0ZV1bW2JvbGQgYmx1ZV0wNFtib2xkIHdoaXRlXV0gIFtib2xkIHdoaXRlXUNSQUNLIEVNQUlMIFJBTkRPTQpbYm9sZCB3aGl0ZV1bW2JvbGQgYmx1ZV0wNVtib2xkIHdoaXRlXV0gIFtib2xkIHdoaXRlXUNIRUsgSEFTSUwgT0svQ1AKW2JvbGQgd2hpdGVdW1tib2xkIGJsdWVdMDZbYm9sZCB3aGl0ZV1dICBbYm9sZCB3aGl0ZV1DSEVLIE9QU0kgQUtVTiBDSEVLUE9JTgpbYm9sZCB3aGl0ZV1bW2JvbGQgYmx1ZV0wMFtib2xkIHdoaXRlXV0gIFtib2xkIHJlZF1RT1VUK0NPS0lFUycnJykgOyBDb25zb2xlKHdpZHRoPTUwKS5wcmludChQYW5lbChsaXN0LHN0eWxlPSdib2xkIHdoaXRlJykpCiAgICBhc3NrID0gY29uc29sZS5pbnB1dCgn4pWa4pWQ4pSA4pSA4pSAIFtib2xkIHdoaXRlXUNob29zZSA6ICcpCiAgICBpZiBhc3NrIGluIFsnMScsJzAxJ106CiAgICAgICAgICBDb25zb2xlKHdpZHRoPTUwKS5wcmludChQYW5lbCgnW2JvbGQgd2hpdGVdS2V0aWsgTUUgY3JhY2sgZGFmdGFyIGZyaWVuZHMgeW91JyxzdHlsZT0nYm9sZCB3aGl0ZScpKQogICAgICAgICAgaWQgPSBjb25zb2xlLmlucHV0KCfilZrilZDilIDilIDilIAgW2JvbGQgd2hpdGVdVGFyZ2V0IElEIDogJykKICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGZvciB4IGluIHJlcXVlc3RzLmdldCgiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20ve30/ZmllbGRzPWZyaWVuZHMubGltaXQoNTAwMSkmYWNjZXNzX3Rva2VuPXt9Ii5mb3JtYXQoaWQsb3BlbignZGF0YS90b2tlbi50eHQnLCdyJykucmVhZCgpKSwgY29va2llcz17ImNvb2tpZSI6b3BlbignZGF0YS9jb2tpZS50eHQnLCdyJykucmVhZCgpfSkuanNvbigpWydmcmllbmRzJ11bJ2RhdGEnXToKICAgICAgICAgICAgICAgICAgICBJRC5hcHBlbmQoeFsnaWQnXSArJy8nKyB4WyduYW1lJ10pCiAgICAgICAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgICAgICAgICBDb25zb2xlKHdpZHRoPTUwKS5wcmludChQYW5lbChmJ1tib2xkIHJlZF1Ba3VuIHtpZH0gdGlkYWsgcHVibGlrLCBjYXJpIHlhbmcgbGFpbicsc3R5bGU9J2JvbGQgd2hpdGUnKSkgOyB0aW1lLnNsZWVwKDIpIDsgbWVudSgpCiAgICAgICAgICBBdHVyVXNlcigpCgogICAgZWxpZiBhc3NrIGluIFsnMicsJzAyJ106CiAgICAgICAgIENvbnNvbGUod2lkdGg9NTApLnByaW50KFBhbmVsKCdbYm9sZCB3aGl0ZV1LZXRpayBtZSBqaWthIGluZ2luIGNyYWNrIGRhcmkgZGFmdGFyIHRlbWFuIGFrdW4gdHVtYmFsIGFuZGEsIGRhbiBndW5ha2FuIHRhbmRhIGtvbWEgdW50dWsgcGVtaXNhaGFuIHVzZXJpZCBjb250b2ggcGVtaXNhaGFuIDogMTAwMDgsMTAwMDUnLHN0eWxlPSdib2xkIHB1cnBsZScpKQogICAgICAgICB6cHJpbnQoJ+KVreKUgOKUgOKWuCBbYm9sZCB3aGl0ZV1QYXN0aWthbiB0YXJnZXQgcHVibGlrJykKICAgICAgICAgaWQgPSBjb25zb2xlLmlucHV0KCfilbDilIDilIDilrggW2JvbGQgd2hpdGVdTWFzdWthbiB1c2VyaWQgOiAnKQogICAgICAgICBmb3Iga29udG9sIGluIGlkLnNwbGl0KCcsJyk6CiAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICBmb3IgZGF0YSBpbiByZXF1ZXN0cy5nZXQoImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tL3t9P2ZpZWxkcz1mcmllbmRzLmxpbWl0KDUwMDEpJmFjY2Vzc190b2tlbj17fSIuZm9ybWF0KGtvbnRvbCxvcGVuKCdkYXRhL3Rva2VuLnR4dCcsJ3InKS5yZWFkKCkpLCBjb29raWVzPXsiY29va2llIjpvcGVuKCdkYXRhL2Nva2llLnR4dCcsJ3InKS5yZWFkKCl9KS5qc29uKClbJ2ZyaWVuZHMnXVsnZGF0YSddOgogICAgICAgICAgICAgICAgICAgICAgIElELmFwcGVuZChkYXRhWydpZCddICsnLycrIGRhdGFbJ25hbWUnXSkKICAgICAgICAgICAgIGV4Y2VwdCBLZXlFcnJvcjpwYXNzCiAgICAgICAgIEF0dXJVc2VyKCkKCiAgICBlbGlmIGFzc2sgaW4gWyczJywnMDMnXToKICAgICAgICAgQ29uc29sZSh3aWR0aD01MCkucHJpbnQoUGFuZWwoJ1tib2xkIHdoaXRlXUtldGlrICBtZSBqaWthIGluZ2luIGNyYWNrIGRhcmkgZGFmdGFyIGZvbGxvd2VycyBzZW5kaXJpLCBndW5ha2FuIHRhbmRhIGtvbWEgdW50dWsgcGVtaXNhaGFuIHVzZXJpZCBjb250b2ggcGVtaXNhaGFuIHVzZXJpZCA6IDEwMDA4LDEwMDA1JyxzdHlsZT0nYm9sZCB3aGl0ZScpKQogICAgICAgICB6cHJpbnQoJ+KVreKUgOKUgOKWuCBbYm9sZCB3aGl0ZV1QYXN0aWthbiB0YXJnZXQgcHVibGlrIScpCiAgICAgICAgIGlkID0gY29uc29sZS5pbnB1dCgn4pWw4pSA4pSA4pa4IFtib2xkIHdoaXRlXU1hc3VrYW4gdXNlcmlkIDogJykKICAgICAgICAgZm9yIFVzZXJQZW5nZ3VuYSBpbiBpZC5zcGxpdCgnLCcpOgogICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIGZvciBkYXRhIGluIHJlcXVlc3RzLmdldCgnaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20ve30/ZmllbGRzPW5hbWUsc3Vic2NyaWJlcnMuZmllbGRzKGlkLG5hbWUpLmxpbWl0KDUwMDApJmFjY2Vzc190b2tlbj17fScuZm9ybWF0KFVzZXJQZW5nZ3VuYSwgdG9rZW4pLCBjb29raWVzPXsnY29va2llJzpjb2tpc30pLmpzb24oKVsnc3Vic2NyaWJlcnMnXVsnZGF0YSddOgogICAgICAgICAgICAgICAgICAgICAgICBJRC5hcHBlbmQoZGF0YVsnaWQnXSArJy8nKyBkYXRhWyduYW1lJ10pCiAgICAgICAgICAgICBleGNlcHQgS2V5RXJyb3I6cGFzcwogICAgICAgICBBdHVyVXNlcigpCgogICAgZWxpZiBhc3NrIGluIFsnNCcsJzA0J106CiAgICAgICAgIENvbnNvbGUod2lkdGg9NTApLnByaW50KFBhbmVsKCdbYm9sZCB3aGl0ZV1NYXN1a2FuIG5hbWEgdGFyZ2V0IGd1bmFrYW4gdGFuZGEga29tYSB1bnR1ayBwZW1pc2FoYW4gY29udG9oIHBlbWlzYWhhbiBuYW1hIDogYW5kaSxhbmRpa2EnLHN0eWxlPSdib2xkIHB1cnBsZScpKQogICAgICAgICBuYW1hID0gY29uc29sZS5pbnB1dCgn4pSc4pSA4pSAIFtib2xkIHdoaXRlXU1hc3VrYW4gbmFtYSB0ZXJnZXQgOiAnKQogICAgICAgICBtYWluID0gY29uc29sZS5pbnB1dCgn4pWa4pWQ4pSA4pSA4pSAIFtib2xkIHdoaXRlXU1hc3VrYW4gZG9tYWluIGNvbnRvaCBAZ21haWwuY29tIDogJykKICAgICAgICAgZm9yIGkgaW4gbmFtYS5zcGxpdCgnLCcpOgogICAgICAgICAgICAgZm9yIHggaW4gcmFuZ2UoMjAwMCk6CiAgICAgICAgICAgICAgICAgdGFtYmFoID0gcmFuZG9tLmNob2ljZShbcmFuZG9tLnJhbmRpbnQoMCw2MCksJ2FtaW4nLCdhbWVsJywnYW1lbGlhJywnYWlzJywnYW5hbmRhJywnYWd1cycsJ2FqaScsJ2FkaScsJ2FuZGknLCdhbmRpa2EnLCdhYmFzJywnYW1pbmFoJywnYW1pbmF0dW4nLCdiYWdhcycsJ2Jhc3VraScsJ2JhYmFzJywnYmF5dScsJ2JhZHJ1bCcsJ2JpbnRhbmcnLCdjaW5kaScsJ2NpY2knLCdjaW50YScsJ2N1cGl0YScsJ2N1cGknLCdkaW5hJywnZGlraScsJ2RpZmEnLCdkaWhpJywnZGluaScsJ2RpdmEnLCdkZXZpbnRhJywnZGVuaScsJ2RpbGEnLCdkaWxhaCcsJ2Zpa2EnLCdmaWtoYScsJ2ZpbmEnLCdmaXZpJywnZmF0YWgnLCdmYW5pYScsJ2ZhdGloJywnZmF0dW4nLHJhbmRvbS5yYW5kaW50KDEsMjApLCczMicsJzI4JywnMTIzJywnMjQnLCdvZmljaWFsJywnY2FucycsJ2dhbnonLCd0b2snLCd4ZCcsJ2lkJywnZ2luYScsJ2dhbGloJywnZ3VndW4nLCdnaWZhaCcsJ2dhbnMnLCdraG9saWQnLCdrb250b2wnLCdrYW5pYScsJ2tob2VydWwnLCdoaWxhZGEnLCdoaWxtaScsJ2hpbWluJywnbGlsaScsJ2xpbmEnLCdsYW5pJywnbGFydWgnLCdtaWEnLCdtYXMnLCdtYXonLCdtYW1hdCcsJ21hbWFkJywnbWFzcnVsJywnbmluYScsJ25paGEnLCduaW5pbmcnLCdudWxhJywnbmFuYScsJ251bnUnLCduaWZ0YScsJ25pdGEnLCduaXZhJywnbmFiaWxhJywnbmFkaWEnLCdvZGknLCdvbmknLCdvam9sJywnb25hbmknLCdwaXRyaScscmFuZG9tLnJhbmRpbnQoMCwzNSksJ3Jvc21hJywncmlza2EnLCdyaW5hJywncmFuaScsJ3JhdHUnLCdyYXRuYScsJ3JpZmEnLCdyaXZhJywncmVuYScsJ3JlemEnLCdyb2ZpaycsJ3Jpc21hJywncm96YScsJ3JvemFrJywnc2lza2EnLCdzYW50aScsJ3NhcmknLCdzYXJubycsJ3N1c2FudGknLCdzaW5kaScsJ3N1Y2knLCdzdXNhbmEnLCdzaW50YScsJ3N1bGlzJywndGl3aScsJ3RpbmEnLCd0YW50aScsJ3Rvbm8nLCd0aWFyYScsJ3RpdGluJywndWxmYScsJ3VsZmFoJywndWxpbicsJ3VsZmluJywndW5haCcsJ3VkaW4nLCd1c21hbicsJ3VzZGluJywndmluYScsJ3ZpbmthJywndmFuaScsJ3ZhdGltYWgnLCd3aW5kYScsJ3dhbnRpJywnd2FuaScsJ3dhZHVsJywneGknLCd6aWRhbicsJ3phZW5hbCcsJ3ppemknLCdsdWttYW4nLCdpcmVuJywnaW5lJywncmVuaScsJ3VmaWsnLCdyb2htYWgnLCdraGFzbmEnLCdhbmRpJywnZHdpJywnbXVoYW1tYWQnLCdudXInLCdkZXdpJywndHJpJywnZGlhbicsJ3NyaScsJ3B1dHJpJywnZWthJywnc2FyaScsJ2FkaXR5YScsJ2Jhc3VraScsJ2J1ZGknLCdqb25pJywndG9uaScsJ2NhaHlhJywncmlza2knLCdmYXJoYW4nLCdhZGVuJywnam9rbycsJ3J1ZGknLCdiYW1iYW5nJywnc3VwcmknLCd3YXdhbicsJ2thcm5hd2FuJywnYWthdHN1a2knLCd3aWJ1JywnY2FrZXAnLCdjYW50aWsnLCcrJyx4LCdoaXRhbScscmFuZG9tLnJhbmRpbnQoMCw2MCksJ3p1bGtpJywnYW5nZ2EnLCd5YXlhbicsJ2RhcHVudGEnLCdyb21pJywnbHVrbWFuJywncm9obWF0JywnYmFzdWtpJywnaGFtemFoJywnYm95JywnY2FoeWFuaScsJ3NhZGl5YWgnLCdzYWxhbWFoJywnYW5pdCddKQogICAgICAgICAgICAgICAgIGFhcGFhbiA9IGYne2l9e3RhbWJhaH0nCiAgICAgICAgICAgICAgICAgamVtYnV0ID0gJ3t9e30ve30nLmZvcm1hdChhYXBhYW4sbWFpbixpKQogICAgICAgICAgICAgICAgIGlmIGplbWJ1dCBpbiBJRDpwYXNzCiAgICAgICAgICAgICAgICAgZWxzZTpJRC5hcHBlbmQoamVtYnV0KQogICAgICAgICBBdHVyVXNlcigpCgogICAgZWxpZiBhc3NrIGluIFsnNScsJzA1J106Q2VrUmVzdWx0cygpCiAgICBlbGlmIGFzc2sgaW4gWyc2JywnMDYnXTpDaGVrT3B0aW9uKCkKICAgIGVsaWYgYXNzayBpbiBbJzAnLCcwMCddOm9zLnN5c3RlbSgncm0gLXJmIGRhdGEvdG9rZW4udHh0ICYmIHJtIC1yZiBjb2tpZS50eHQnKSA7IGV4aXQoMCkKICAgIGVsc2U6bWVudSgpCgpkZWYgQXR1clVzZXIoKToKICAgIENvbnNvbGUod2lkdGg9NTApLnByaW50KFBhbmVsKGYnW2JvbGQgZ3JlZW5dW1tib2xkIHdoaXRlXeKck1tib2xkIGdyZWVuXV0gW2JvbGQgd2hpdGVdVE9UQUwgSUQgOiB7bGVuKElEKX0nLHN0eWxlPSdib2xkIHdoaXRlJykpCiAgICBleGVjID0gKCcnJ1tib2xkIHdoaXRlXVtbYm9sZCBibHVlXTAxW2JvbGQgd2hpdGVdXSAgW2JvbGQgd2hpdGVdQ3JhY2sgb2xkIDEwMDA2Cltib2xkIHdoaXRlXVtbYm9sZCBibHVlXTAyW2JvbGQgd2hpdGVdXSAgW2JvbGQgd2hpdGVdQ3JhY2sgbmV3IDEwMDA4Cltib2xkIHdoaXRlXVtbYm9sZCBibHVlXTAzW2JvbGQgd2hpdGVdXSAgW2JvbGQgd2hpdGVdQ3JhY2sgcmFuZG9tIGFsbCBpZCcnJykgOyBDb25zb2xlKHdpZHRoPTUwKS5wcmludChQYW5lbChleGVjICxzdHlsZT0nYm9sZCB3aGl0ZScpKQogICAgaWRuZGkgPSBjb25zb2xlLmlucHV0KCfilZrilZDilIDilIDilIAgW2JvbGQgd2hpdGVdQ2hvb3NlOiAnKQogICAgaWYgaWRuZGkgaW4gWycxJywnMDEnXToKICAgICAgICAgZm9yIGkgaW4gSUQ6CiAgICAgICAgICAgICAgIElEMi5hcHBlbmQoaSkKICAgIGVsaWYgaWRuZGkgaW4gWycyJywnMDInXToKICAgICAgICAgZm9yIGkgaW4gSUQ6CiAgICAgICAgICAgICBJRDIuaW5zZXJ0KDAsaSkKICAgIGVsc2U6CiAgICAgICAgIGZvciBpIGluIElEOgogICAgICAgICAgICAgeHggPSByYW5kb20ucmFuZGludCgwLCBsZW4oSUQyKSkKICAgICAgICAgICAgIElEMi5pbnNlcnQoeHgsIGkpCiAgICBBdHVyTG9naW4oKQoKZGVmIEF0dXJMb2dpbigpOgogICAgbWV0b2QgPSAoJycnW2JvbGQgd2hpdGVdW1tib2xkIGJsdWVdMDFbYm9sZCB3aGl0ZV1dICBbYm9sZCB3aGl0ZV1DcmFjayAgbWV0aG9kZSBbYm9sZCBncmVlbl1yZWd1bGVyCltib2xkIHdoaXRlXVtbYm9sZCBibHVlXTAyW2JvbGQgd2hpdGVdXSAgW2JvbGQgd2hpdGVdQ3JhY2sgIG1ldGhvZGUgd2ViIHJlZ3VsZXIgW2JvbGQgcmVkXU9GRgpbYm9sZCB3aGl0ZV1bW2JvbGQgYmx1ZV0wM1tib2xkIHdoaXRlXV0gIFtib2xkIHdoaXRlXUNyYWNrICBtZXRob2RlW2JvbGQgYmx1ZV0gdmFsaWRhdGVbYm9sZCB3aWh0ZV0gcGFzc3dvcmQgJycnKSA7IENvbnNvbGUod2lkdGg9NTApLnByaW50KFBhbmVsKG1ldG9kLHN0eWxlPSdib2xkIHdoaXRlJykpCiAgICB6ID0gY29uc29sZS5pbnB1dCgn4pWa4pWQ4pSA4pSA4pSAIFtib2xkIHdoaXRlXUNIT09TRSA6ICcpCiAgICBpZiB6IGluIFsnMScsJzAxJ106dG9kLmFwcGVuZCgncmVndWxlcicpCiAgICBlbGlmIHogaW4gWycyJywnMDInXTp0b2QuYXBwZW5kKCdyZWd1bGVyIHdlYicpCiAgICBlbGlmIHogaW4gWyczJywnMDMnXTp0b2QuYXBwZW5kKCd2YWxpZGF0ZScpCiAgICBlbHNlOnRvZC5hcHBlbmQoJ3JlZ3VsZXInKQoKICAgIGV4ZWMgPSAoJycnW2JvbGQgd2hpdGVdW1tib2xkIHdoaXRlXTAxW2JvbGQgd2hpdGVdXSAgW2JvbGQgd2hpdGVdWW91IG1ldG9kZVtib2xkIGJsdWVdIGZyZWUuZmFjZWJvb2suY29tCltib2xkIHdoaXRlXVtbYm9sZCB3aGl0ZV0wMltib2xkIHdoaXRlXV0gIFtib2xkIHdoaXRlXVlvdSBtZXRvZGVbYm9sZCByZWRdIG1iYXNpYy5mYWNlYm9vay5jb20KW2JvbGQgd2hpdGVdW1tib2xkIHdoaXRlXTAzW2JvbGQgd2hpdGVdXSAgW2JvbGQgd2hpdGVdWW91IG1ldG9kZVtib2xkIGdyZWVuXSBtb2JpbGUuZmFjZWJvb2suY29tJycnKSA7IENvbnNvbGUod2lkdGg9NTApLnByaW50KFBhbmVsKGV4ZWMgLHN0eWxlPSdib2xkIHdoaXRlJykpCiAgICBsaW5rID0gY29uc29sZS5pbnB1dCgn4pWa4pWQ4pSA4pSA4pSAIFtib2xkIHdoaXRlXUNob29zZSA6ICcpCiAgICBpZiBsaW5rIGluIFsnMScsJzAxJ106dXJsPSdmcmVlLmZhY2Vib29rLmNvbScKICAgIGVsaWYgbGluayBpbiBbJzInLCcwMiddOnVybD0nbWJhc2ljLmZhY2Vib29rLmNvbScKICAgIGVsc2U6dXJsPSdtLmZhY2Vib29rLmNvbScKCiAgICBwd2ggPSAoJ1tib2xkIGdyZWVuXVtbYm9sZCB3aGl0ZV0/W2JvbGQgZ3JlZW5dXSBbYm9sZCB3aGl0ZV1NYXUgbWVuZ3ViYWggcGFzc3dvcmQgYWt1biBPSz8nKSA7IENvbnNvbGUod2lkdGg9NTApLnByaW50KFBhbmVsKHB3aCxzdHlsZT0nYm9sZCB3aGl0ZScpKQogICAgdWJhaCA9IGNvbnNvbGUuaW5wdXQoJ+KVmuKVkOKUgOKUgOKUgCBbYm9sZCB3aGl0ZV1VYmFoIGthdGEgc2FuZGkgW2JvbGQgZ3JlZW5dWS9bYm9sZCByZWRdVCA6ICcpCiAgICBpZiB1YmFoIGluIFsneScsJ1knLCdpeWEnXToKICAgICAgICAgIFViYWhQdy5hcHBlbmQoJ3lhJykKICAgICAgICAgIGFkZF9QYXNzd29yZCA9IGNvbnNvbGUuaW5wdXQoJ+KVmuKVkOKUgOKUgOKUgCBbYm9sZCB3aGl0ZV1NYXN1a2FuIHBhc3N3b3JkIGJhcnUgOiBbYm9sZCBncmVlbl0nKQogICAgICAgICAgaWYgbGVuKGFkZF9QYXNzd29yZCkgPD01OgogICAgICAgICAgICAgICBleGl0KCdcbiDilZrilZDilIDilIDilIAgUGFzc3dvcmQgaGFydXMgbGViaWggZGFyaSA1IGthcmFrdGFlciBjb250b2ggOiBzYXlhbmcnKQogICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgb3BlbigncGFzc3dvcmRfYmFydV9rYW11LnR4dCcsJ3cnKS53cml0ZShhZGRfUGFzc3dvcmQpCiAgICBlbHNlOlViYWhQdy5hcHBlbmQoJ25vJykKICAgIFdvcmRsaXN0TG9naW4oKS5wYXNzd29yZCh1cmwpCgpjbGFzcyBXb3JkbGlzdExvZ2luOgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgcGFzc3dvcmQoc2VsZixsaW5rKToKICAgICAgICBleGVjID0gKGYnW2JvbGQgZ3JlZW5dW1tib2xkIHdoaXRlXSpbYm9sZCBncmVlbl1dLiBbYm9sZCB3aGl0ZV1PSyBzYXZlIGluIDogT0sve2luZG99LnR4dFxuW2JvbGQgZ3JlZW5dW1tib2xkIHdoaXRlXSpbYm9sZCBncmVlbl1dLiBbYm9sZCB3aGl0ZV1DUCBzYXZlIGluIDogQ1Ave2luZG99LnR4dCcpIDsgQ29uc29sZSh3aWR0aD01MCkucHJpbnQoUGFuZWwoZXhlYyAsc3R5bGU9J2JvbGQgd2hpdGUnKSkKICAgICAgICB3aXRoIGx1a21hblhWKG1heF93b3JrZXJzPTMwKSBhcyBjb2lkOgogICAgICAgICAgICAgZm9yIFVzZXJBa3VuIGluIElEMjoKICAgICAgICAgICAgICAgICAgdWlkLG5hbWEgPSBVc2VyQWt1bi5zcGxpdCgnLycpCiAgICAgICAgICAgICAgICAgIHRlcnNlcmFoID0gbmFtYS5zcGxpdCgnICcpWzBdCiAgICAgICAgICAgICAgICAgIGlmIGxlbihuYW1hKSA8PTU6CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGxlbih0ZXJzZXJhaCkgPD0xIG9yIGxlbih0ZXJzZXJhaCkgPD0yOnBhc3MKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB3eCA9IFt0ZXJzZXJhaCsnMTIzJywgdGVyc2VyYWgrJzEyMzQnLCB0ZXJzZXJhaCsnMTIzNDUnLHRlcnNlcmFoKyczMjEnLCdzYXlhbmcnLCdrYXRhIHNhbmRpJywnYmlzbWlsbGFoJyxuYW1hLmxvd2VyKCldCiAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIHB3eCA9IFtuYW1hLCB0ZXJzZXJhaCsnMTIzJywgdGVyc2VyYWgrJzEyMzQnLCB0ZXJzZXJhaCsnMTIzNDUnLCB0ZXJzZXJhaCsnMzIxJywnc2F5YW5nJywna2F0YSBzYW5kaScsJ2Jpc21pbGxhaCcsbmFtYS5sb3dlcigpXQoKICAgICAgICAgICAgICAgICAgaWYgJ3JlZ3VsZXInIGluIHRvZDpjb2lkLnN1Ym1pdChzZWxmLmNyYWNreHYsIHVpZCwgcHd4LCBsaW5rKQogICAgICAgICAgICAgICAgICBlbGlmICdyZWd1bGVyIHdlYicgaW4gdG9kOmNvaWQuc3VibWl0KHNlbGYuY3JhY2t4diwgdWlkLCBwd3gsIGxpbmspCiAgICAgICAgICAgICAgICAgIGVsaWYgJ3ZhbGlkYXRlJyBpbiB0b2Q6Y29pZC5zdWJtaXQoc2VsZi5WYWxpZGF0ZSwgdWlkLCBwd3gsIGxpbmspCiAgICAgICAgICAgICAgICAgIGVsc2U6Y29pZC5zdWJtaXQoc2VsZi5jcmFja1dFYiwgdWlkLCBwd3gsIGxpbmspCgogICAgICAgIGV4aXQoZidcblxuIOKckyBDcmFjayBEb25lIE9LOntsZW4oT0spfSBDUDp7bGVuKENQKX0nKQoKICAgIGRlZiBVc2VyQWdlbnQoc2VsZik6CiAgICAgICAgcnIgPSByYW5kb20ucmFuZGludAogICAgICAgIHJjID0gcmFuZG9tLmNob2ljZQogICAgICAgIGF6ID0gWydBJywnQicsICdDJywgJ0QnLCAnRScsICdGJywgJ0cnLCAnSCcsICdJJywgJ0onLCAnSycsICdMJywgJ00nLCAnTicsICdPJywgJ1AnLCAnUScsICdSJywgJ1MnLCAnVCcsICdVJywgJ1YnLCAnVycsICdYJywgJ1knLCAnWiddCiAgICAgICAgcmV0dXJuIHN0cihyYyhbZiJNb3ppbGxhLzUuMCAoTGludXg7IFU7IEFuZHJvaWQge3N0cihycig0LDEyKSl9OyBlbi11czsgT1BQTyBBe3N0cihycigzMCw1NykpfSBCdWlsZC97c3RyKHJjKGF6KSl9e3N0cihyYyhheikpfXtzdHIocmMoYXopKX17c3RyKHJyKDExLDk5KSl9e3N0cihyYyhheikpfSkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgVmVyc2lvbi80LjAgQ2hyb21lL3tzdHIocnIoMjAsMTAwKSl9LjAue3N0cihycigxMTExLDk5OTkpKX0uODAgTW9iaWxlIFNhZmFyaS81MzcuMzYge3N0cihyYyhbJ1M0ME92aUJyb3dzZXInLCdIZXlUYXBCcm93c2VyJ10pKX0ve3N0cihycigyLDQwKSl9LjcuMzYuMSIsZiJNb3ppbGxhLzUuMCAoTGludXg7IFU7IEFuZHJvaWQge3N0cihycig1LDEyKSl9OyBlbi11czsgR017c3RyKHJyKDExMTEsOTk5OSkpfSBCdWlsZC97c3RyKHJjKGF6KSl9e3N0cihyYyhheikpfXtzdHIocmMoYXopKX17c3RyKHJyKDEsMTApKX0ue3N0cihycigxMTExMTEsOTk5OTk5KSl9LjAwMylBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9uLzQuMCBDaHJvbWUve3N0cihycigxMCwxMDApKX0uMC57c3RyKHJyKDExMTEsOTk5OSkpfS44MCBNb2JpbGUgU2FmYXJpLzUzNy4zNiBTYW1zdW5nQnJvd3Nlci97c3RyKHJyKDIsNDUpKX0uNy4wLjAiXSkpCgogICAgZGVmIGNyYWNreHYoc2VsZiwgdXNlciwgcHd4LCB1cmwpOgogICAgICAgIGdsb2JhbCBsb29wLCBPSyxDUAogICAgICAgIHByaW50KGYnXHIgXDAzM1s5N21jcmFjayB7SH17dXJsfXtOfSB7bG9vcH0ve2xlbihJRDIpfSBPSzp7bGVuKE9LKX0gQ1A6e2xlbihDUCl9JywgZW5kPScgJyk7IHN5cy5zdGRvdXQuZmx1c2goKQogICAgICAgIGZvciBwdyBpbiBwd3g6CiAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgIHdpdGggcmVxdWVzdHMuU2Vzc2lvbigpIGFzIHNlczoKICAgICAgICAgICAgICAgICAgICAgICAgICBhZ2VuID0gc2VsZi5Vc2VyQWdlbnQoKQogICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmsgPSBzZXMuZ2V0KCdodHRwczovL3t9L2xvZ2luLz9uZXh0PWh0dHBzJTNBJTJGJTJGZGV2ZWxvcGVycy5mYWNlYm9vay5jb20lMkZ0b29scyUyRmRlYnVnJTJGJnJlZnNyYz1kZXByZWNhdGVkJl9yZHInLmZvcm1hdCh1cmwpKS50ZXh0CiAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHsnbHNkJzpyZS5zZWFyY2goJ25hbWU9ImxzZCIgdmFsdWU9IiguKj8pIicsIGxpbmspLmdyb3VwKDEpLCdqYXpvZXN0JzpyZS5zZWFyY2goJ25hbWU9Imphem9lc3QiIHZhbHVlPSIoLio/KSInLCBsaW5rKS5ncm91cCgxKSwnbV90cyc6cmUuc2VhcmNoKCduYW1lPSJtX3RzIiB2YWx1ZT0iKC4qPykiJywgbGluaykuZ3JvdXAoMSksJ2xpJzpyZS5zZWFyY2goJ25hbWU9ImxpIiB2YWx1ZT0iKC4qPykiJywgbGluaykuZ3JvdXAoMSksJ3RyeV9udW1iZXInOicwJywndW5yZWNvZ25pemVkX3RyaWVzJzonMCcsJ2VtYWlsJzp1c2VyLCdwYXNzJzpwdywnbG9naW4nOidNYXN1aycsJ2JpX3hyd2gnOicwJ30KICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkID0geydIb3N0JzogdXJsLCdjb250ZW50LWxlbmd0aCc6ICcxMjgnLCdjYWNoZS1jb250cm9sJzogJ21heC1hZ2U9MCcsJ3NlYy1jaC11YSc6ICciIE5vdCBBO0JyYW5kIjt2PSI5OSIsICJDaHJvbWl1bSI7dj0iOTkiLCAiR29vZ2xlIENocm9tZSI7dj0iOTkiJywnc2VjLWNoLXVhLW1vYmlsZSc6ICc/MScsJ3NlYy1jaC11YS1wbGF0Zm9ybSc6ICciQW5kcm9pZCInLCd1cGdyYWRlLWluc2VjdXJlLXJlcXVlc3RzJzogJzEnLCdvcmlnaW4nOiAnaHR0cHM6Ly8nICsgdXJsLCdjb250ZW50LXR5cGUnOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJywndXNlci1hZ2VudCc6IGFnZW4sJ2FjY2VwdCc6ICd0ZXh0L2h0bWwsYXBwbGljYXRpb24veGh0bWwreG1sLGFwcGxpY2F0aW9uL3htbDtxPTAuOSxpbWFnZS9hdmlmLGltYWdlL3dlYnAsaW1hZ2UvYXBuZywqLyo7cT0wLjgsYXBwbGljYXRpb24vc2lnbmVkLWV4Y2hhbmdlO3Y9YjM7cT0wLjknLCdzZWMtZmV0Y2gtc2l0ZSc6ICdzYW1lLW9yaWdpbicsJ3NlYy1mZXRjaC1tb2RlJzogJ25hdmlnYXRlJywnc2VjLWZldGNoLXVzZXInOiAnPzEnLCdzZWMtZmV0Y2gtZGVzdCc6ICdkb2N1bWVudCcsJ3JlZmVyZXInOiAnaHR0cHM6Ly97fS9sb2dpbi8/bmV4dD1odHRwcyUzQSUyRiUyRmRldmVsb3BlcnMuZmFjZWJvb2suY29tJTJGdG9vbHMlMkZkZWJ1ZyUyRiZyZWZzcmM9ZGVwcmVjYXRlZCZfcmRyJy5mb3JtYXQodXJsKSwnYWNjZXB0LWVuY29kaW5nJzogJ2d6aXAsIGRlZmxhdGUsIGJyJywnYWNjZXB0LWxhbmd1YWdlJzogJ2lkLUlELGlkO3E9MC45LGVuLVVTO3E9MC44LGVuO3E9MC43LHJ1O3E9MC42LGp2O3E9MC41J30KICAgICAgICAgICAgICAgICAgICAgICAgICB6enp6ID0gc2VzLnBvc3QoJ2h0dHBzOi8ve30vbG9naW4vZGV2aWNlLWJhc2VkL3JlZ3VsYXIvbG9naW4vP25leHQ9aHR0cHMlM0ElMkYlMkZkZXZlbG9wZXJzLmZhY2Vib29rLmNvbSUyRnRvb2xzJTJGZGVidWclMkYmYW1wO3JlZnNyYz1kZXByZWNhdGVkJmFtcDtsd3Y9MTAwJy5mb3JtYXQodXJsKSwgZGF0YT1kYXRhLCBoZWFkZXJzPWhlYWQsIGFsbG93X3JlZGlyZWN0cz1GYWxzZSkKICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAnY191c2VyJyBpbiBzZXMuY29va2llcy5nZXRfZGljdCgpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga3VlaCA9ICc7Jy5qb2luKFtzdHIoYSkrJz0nK3N0cihiKSBmb3IgYSxiIGluIHNlcy5jb29raWVzLmdldF9kaWN0KCkuaXRlbXMoKV0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dWlkID0gcmUuc2VhcmNoKCdjX3VzZXI9KC4qPyk7Jywga3VlaCkuZ3JvdXAoMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICd5YScgaW4gVWJhaFB3OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoJ1xyICVzKiAgLS0+ICVzfCVzfCVzCQkJICAnJShILHV1aWQscHcsa3VlaCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLlViYWhQYXNzd29yZCh1dWlkLHB3LGt1ZWgsdXJsKQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludCgnXHIgJXPilJTilIDilIAgb2sgJXN8JXN8JXMJCSclKEgsdXVpZCxwdyxrdWVoKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wZW4oJ09LL3t9LnR4dCcuZm9ybWF0KGluZG8pLCdhJykud3JpdGUoJyVzfCVzfCVzXG4nJSh1c2VyLHB3LGt1ZWgpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgT0suYXBwZW5kKCdET1NBJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCgogICAgICAgICAgICAgICAgICAgICAgICAgIGVsaWYgJ2NoZWNrcG9pbnQnIGluIHNlcy5jb29raWVzLmdldF9kaWN0KCk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dWlkID0gc2VzLmNvb2tpZXMuZ2V0X2RpY3QoKVsiY2hlY2twb2ludCJdLnNwbGl0KCIlIilbNF0ucmVwbGFjZSgiM0EiLCAiIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KCdcciAlc+KUlOKUgOKUgCBjcCAlc3wlcyAgICAgICAgICAgICAgICAgICBceDFiWzE7OTFtJyUoSyx1dWlkLHB3KSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wZW4oJ0NQL3t9LnR4dCcuZm9ybWF0KGluZG8pLCdhJykud3JpdGUoJyVzfCVzXG4nJSh1dWlkLHB3KSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENQLmFwcGVuZCgnVEFJJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCgogICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgZXhjZXB0IHJlcXVlc3RzLmV4Y2VwdGlvbnMuQ29ubmVjdGlvbkVycm9yOiB0aW1lLnNsZWVwKDMwKQogICAgICAgIGxvb3AgKz0xCgogICAgZGVmIFZhbGlkYXRlKHNlbGYsIHVzZXIsIHB3eCwgdXJsKToKICAgICAgICBnbG9iYWwgbG9vcCwgT0ssIENQCiAgICAgICAgcHJpbnQoZidcciBcMDMzWzk3bWNyYWNrIHtIfXt1cmx9e059IHtsb29wfS97bGVuKElEMil9IE9LOntsZW4oT0spfSBDUDp7bGVuKENQKX0nLCBlbmQ9JyAnKTsgc3lzLnN0ZG91dC5mbHVzaCgpCiAgICAgICAgZm9yIHB3IGluIHB3eDoKICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgd2l0aCByZXF1ZXN0cy5TZXNzaW9uKCkgYXMgeDoKICAgICAgICAgICAgICAgICAgICAgICAgICBhZ2VuID0gdWEgIydNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgOC4wLjA7IEFTVVNfWDAwUkQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS83MC4wLjM1MzguMTEwIE1vYmlsZSBTYWZhcmkvNTM3LjM2IiwnCiAgICAgICAgICAgICAgICAgICAgICAgICAgbGluayA9IHguZ2V0KCdodHRwczovL3t9L2xvZ2luL2RldmljZS1iYXNlZC9wYXNzd29yZC8/dWlkPXt9Jm5leHQ9aHR0cHMlM0ElMkYlMkZkZXZlbG9wZXJzLmZhY2Vib29rLmNvbSUyRndlYm1hc3RlciUyRiZmbG93PWxvZ2luX25vX3BpbiZyZWZzcmM9ZGVwcmVjYXRlZCZfcmRyJy5mb3JtYXQodXJsLHVzZXIpKS50ZXh0CiAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHsnbHNkJzpyZS5zZWFyY2goJ25hbWU9ImxzZCIgdmFsdWU9IiguKj8pIicsIGxpbmspLmdyb3VwKDEpLCdqYXpvZXN0JzpyZS5zZWFyY2goJ25hbWU9Imphem9lc3QiIHZhbHVlPSIoLio/KSInLCBsaW5rKS5ncm91cCgxKSwndWlkJzp1c2VyLCduZXh0JzonaHR0cHM6Ly9kZXZlbG9wZXJzLmZhY2Vib29rLmNvbS93ZWJtYXN0ZXIvJywnZmxvdyc6J2xvZ2luX25vX3BpbicsJ2VuY3Bhc3MnOicjUFdEX0JST1dTRVI6MDp7fTp7fScuZm9ybWF0KHJhbmRvbS5yYW5kaW50KDAwMDAwMDAwMDAsIDk5OTk5OTk5OTkpLHB3KX0KICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkID0geydIb3N0JzogdXJsLCdjb250ZW50LWxlbmd0aCc6ICczMTknLCdjYWNoZS1jb250cm9sJzogJ21heC1hZ2U9MCcsJ3NlYy1jaC11YSc6ICciIE5vdCBBO0JyYW5kIjt2PSI5OSIsICJDaHJvbWl1bSI7dj0iOTkiLCAiR29vZ2xlIENocm9tZSI7dj0iOTkiJywnc2VjLWNoLXVhLW1vYmlsZSc6ICc/MScsJ3NlYy1jaC11YS1wbGF0Zm9ybSc6ICciQW5kcm9pZCInLCd1cGdyYWRlLWluc2VjdXJlLXJlcXVlc3RzJzogJzEnLCdvcmlnaW4nOiAnaHR0cHM6Ly8nICsgdXJsLCdjb250ZW50LXR5cGUnOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJywndXNlci1hZ2VudCc6IGFnZW4sJ2FjY2VwdCc6ICd0ZXh0L2h0bWwsYXBwbGljYXRpb24veGh0bWwreG1sLGFwcGxpY2F0aW9uL3htbDtxPTAuOSxpbWFnZS9hdmlmLGltYWdlL3dlYnAsaW1hZ2UvYXBuZywqLyo7cT0wLjgsYXBwbGljYXRpb24vc2lnbmVkLWV4Y2hhbmdlO3Y9YjM7cT0wLjknLCdzZWMtZmV0Y2gtc2l0ZSc6ICdzYW1lLW9yaWdpbicsJ3NlYy1mZXRjaC1tb2RlJzogJ25hdmlnYXRlJywnc2VjLWZldGNoLXVzZXInOiAnPzEnLCdzZWMtZmV0Y2gtZGVzdCc6ICdkb2N1bWVudCcsJ3JlZmVyZXInOiAnaHR0cHM6Ly97fS9sb2dpbi9kZXZpY2UtYmFzZWQvcGFzc3dvcmQvP3VpZD17fSZuZXh0PWh0dHBzJTNBJTJGJTJGZGV2ZWxvcGVycy5mYWNlYm9vay5jb20lMkZ3ZWJtYXN0ZXIlMkYmZmxvdz1sb2dpbl9ub19waW4mcmVmc3JjPWRlcHJlY2F0ZWQmX3JkcicuZm9ybWF0KHVybCx1c2VyKSwnYWNjZXB0LWVuY29kaW5nJzogJ2d6aXAsIGRlZmxhdGUsIGJyJywnYWNjZXB0LWxhbmd1YWdlJzogJ2lkLUlELGlkO3E9MC45LGVuLVVTO3E9MC44LGVuO3E9MC43LHJ1O3E9MC42LGp2O3E9MC41J30KICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NoID0geC5wb3N0KCdodHRwczovL3t9L2xvZ2luL2RldmljZS1iYXNlZC92YWxpZGF0ZS1wYXNzd29yZC8/c2hibD0wJy5mb3JtYXQodXJsKSxkYXRhPWRhdGEsIGhlYWRlcnM9aGVhZCwgYWxsb3dfcmVkaXJlY3RzPUZhbHNlKQogICAgICAgICAgICAgICAgICAgICAgICAgIGlmICdjX3VzZXInIGluIHguY29va2llcy5nZXRfZGljdCgpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga3VlaCA9ICc7Jy5qb2luKFtzdHIoYSkrJz0nK3N0cihiKSBmb3IgYSxiIGluIHguY29va2llcy5nZXRfZGljdCgpLml0ZW1zKCldKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXVpZCA9IHJlLnNlYXJjaCgnY191c2VyPSguKj8pOycsIGt1ZWgpLmdyb3VwKDEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAneWEnIGluIFViYWhQdzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KCdcciAlcyogIC0tPiAlc3wlc3wlcyAgICAgICAgICAgICAnJShILHV1aWQscHcsa3VlaCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLlViYWhQYXNzd29yZCh1dWlkLHB3LGt1ZWgsdXJsKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KCdcciAlcyogIC0tPiAlc3wlc3wlcyAgICAgICAgICAgICAnJShILHV1aWQscHcsa3VlaCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcGVuKCdPSy97fS50eHQnLmZvcm1hdChpbmRvKSwnYScpLndyaXRlKCclc3wlc3wlc1xuJyUodXNlcixwdyxrdWVoKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9LLmFwcGVuZCgnRE9TQSBMVSBCQU5HIE1BTElORycpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawoKICAgICAgICAgICAgICAgICAgICAgICAgICBlbGlmICdjaGVja3BvaW50JyBpbiB4LmNvb2tpZXMuZ2V0X2RpY3QoKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KCdcciAlcyogIC0tPiAlc3wlcyAgICAgICAgICAgICAgICAgICBceDFiWzE7OTFtJyUoSyx1c2VyLHB3KSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wZW4oJ0NQL3t9LnR4dCcuZm9ybWF0KGluZG8pLCdhJykud3JpdGUoJyVzfCVzXG4nJSh1c2VyLHB3KSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENQLmFwcGVuZCgnVEFJIEtVTklORycpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOnByaW50KGUpCiAgICAgICAgbG9vcCArPTEKCiAgICBkZWYgVWJhaFBhc3N3b3JkKHNlbGYsIHVzZXIsIHBhc3N3b3JkX29sZCwgY29raSwgdXJsKToKICAgICAgICB0cnk6cGFzc3dvcmRfbmV3ID0gb3BlbigncGFzc3dvcmRfYmFydV9rYW11LnR4dCcsJ3InKS5yZWFkKCkKICAgICAgICBleGNlcHQ6cGFzc3dvcmRfbmV3ID0gcGFzc3dvcmRfb2xkCiAgICAgICAgd2l0aCByZXF1ZXN0cy5TZXNzaW9uKCkgYXMgc2VzOgogICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICBsaW5rID0gc2VzLmdldChmJ2h0dHBzOi8ve3VybH0vc2V0dGluZ3Mvc2VjdXJpdHkvcGFzc3dvcmQvJyxjb29raWVzPXsnY29va2llJzpjb2tpfSkKICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICdmYl9kdHNnJzpyZS5zZWFyY2goJ25hbWU9ImZiX2R0c2ciIHZhbHVlPSIoLio/KSInLCBsaW5rLnRleHQpLmdyb3VwKDEpLAogICAgICAgICAgICAgICAgICAgICAgICAgJ2phem9lc3QnOnJlLnNlYXJjaCgnbmFtZT0iamF6b2VzdCIgdmFsdWU9IiguKj8pIicsIGxpbmsudGV4dCkuZ3JvdXAoMSksCiAgICAgICAgICAgICAgICAgICAgICAgICAncGFzc3dvcmRfY2hhbmdlX3Nlc3Npb25faWRlbnRpZmllcic6cmUuc2VhcmNoKCduYW1lPSJwYXNzd29yZF9jaGFuZ2Vfc2Vzc2lvbl9pZGVudGlmaWVyIiB2YWx1ZT0iKC4qPykiJywgbGluay50ZXh0KS5ncm91cCgxKSwKICAgICAgICAgICAgICAgICAgICAgICAgICdwYXNzd29yZF9vbGQnOnBhc3N3b3JkX29sZCwKICAgICAgICAgICAgICAgICAgICAgICAgICdwYXNzd29yZF9uZXcnOnBhc3N3b3JkX25ldywKICAgICAgICAgICAgICAgICAgICAgICAgICdwYXNzd29yZF9jb25maXJtJzpwYXNzd29yZF9uZXcsCiAgICAgICAgICAgICAgICAgICAgICAgICAnc2F2ZSc6J1NpbXBhbiBwZXJ1YmFoYW4nCiAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgZmluZCA9IHBhcnNlKGxpbmsudGV4dCwnaHRtbC5wYXJzZXInKS5maW5kKCdmb3JtJyxtZXRob2Q9J3Bvc3QnKVsnYWN0aW9uJ10KICAgICAgICAgICAgICAgICAgICAgcG9zaCA9IHNlcy5wb3N0KGYnaHR0cHM6Ly97dXJsfScgKyBmaW5kLCBkYXRhPWRhdGEsIGNvb2tpZXMgPSB7J2Nvb2tpZSc6Y29raX0pCiAgICAgICAgICAgICAgICAgICAgIGlmICdLYXRhIFNhbmRpIFRlbGFoIERpdWJhaCcgaW4gcG9zaC50ZXh0OgogICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KCdcciAlcyogIC0tPiBCZXJoYXNpbCBtZW5nZ2FudGkgcGFzc3dvcmQgYWt1biA6ICVzIG1lbmphZGkgJXMnJShILHVzZXIscGFzc3dvcmRfbmV3KSkKICAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludCgnXHIgJXMqICAtLT4gR2FnYWwgbWVuZ2dhbnRpIHBhc3N3b3JkIGFrdW4gOiAlcyBtZW5qYWRpICVzJyUoTSx1c2VyLHBhc3N3b3JkX25ldykpCiAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6cHJpbnQoJ1xyICVzKiAgLS0+IEdhZ2FsIG1lbmd1YmFoIHBhc3N3b3JkIGFrdW4gOiAlcyclKE0sdXNlcikpCgpkZWYgZm9sZGVyKCk6CiAgICB0cnk6b3MubWtkaXIoJ09LJykKICAgIGV4Y2VwdDpwYXNzCiAgICB0cnk6b3MubWtkaXIoJ0NQJykKICAgIGV4Y2VwdDpwYXNzCiAgICB0cnk6b3MubWtkaXIoJ2RhdGEnKQogICAgZXhjZXB0OnBhc3MKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6Cglvcy5zeXN0ZW0oJ2dpdCBwdWxsJykKCWZvbGRlcigpCgltZW51KCkK'))